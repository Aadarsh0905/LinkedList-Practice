package LinkedList.DoublyLInkedList;

class Node{
    int data;
    Node prev;
    Node next;
    Node (int data){
        this.data=data;
        this.next=null;
        this.prev=null;
    }
}
public class InsertOperation {
    public static void main(String[] args) {
    
    }
    public static Node insertFirstNode(Node head,int value){
        Node newnode=new Node(value);
        if(head==null){
            head=newnode;
            return head;
        }
        newnode.next=head;
        head.prev=newnode;
        head=newnode;
        return head;
    }
    public static Node insertLastNode(Node head,int value){
        Node newnode=new Node(value);
        if(head==null){
            head=newnode;
            return head;
        }
        Node temp=head;
        while(temp.next!=null){
            temp=temp.next;
        }
        temp.next=newnode;
        newnode.prev=temp;
        return head;
    }
//    public static Node insertAtKthNode(Node head,int k,int value){
//        Node newnode=new Node(value);
//        if(head==null){
//            if(k==1)return insertFirstNode(head,value);
//            else return null;
//        }
//        int cnt=0;
//        Node temp=head;
//        while(temp.next!=null){
//            cnt++;
//            if(cnt==k-1){
//                temp.next.prev=newnode;
//                newnode.next=temp.next;
//                temp.next=newnode;
//                newnode.prev=temp;
//                break;
//            }
//            temp=temp.next;
//        }
//        return head;
//    }
    public static Node insertAtKthNode(Node head, int k, int value) {
        if (k <= 0) return head;  // invalid position
        if (k == 1) {
            return insertFirstNode(head, value);
        }
        Node newNode = new Node(value);
        Node temp = head;
        int cnt = 1;
        while (temp != null && cnt < k - 1) {
            temp = temp.next;
            cnt++;
        }
        // If position is invalid
        if (temp == null) return head;
        newNode.next = temp.next;
        newNode.prev = temp;
        if (temp.next != null) {
            temp.next.prev = newNode;
        }
        temp.next = newNode;
        return head;
    }
    public static Node insertBeforeNode(Node head,int val,int k){
        if(head==null)return null;
        if(head.data==k)return insertFirstNode(head,val);
        Node temp=head;
        while(temp.next!=null){
            if(temp.next.data==k){
                Node newnode=new Node(val);
                newnode.next=temp.next;
                temp.next.prev=newnode;
                temp.next=newnode;
                newnode.prev=temp;
                break;
            }
            temp=temp.next;
        }
        return head;
    }

}
